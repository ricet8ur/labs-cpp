# Реквизиты
Жолобов Даниил Валерьевич
3 курс
z33434
2024

# ЛР #4: [C++ & UNIX]: C++ PROCESSES / THREADS

# Цель

Познакомить студента с принципами параллельных вычислений. Составить несколько программ в простейшими вычислительными действиями, чтобы освоить принципы параллельных вычислений (когда одни алгоритмы зависят / не зависят от других).

# Задача

1. [С++ SEQUENCE] Последовательные вычисления

<pre>
Требуется последовательно выполнить вычисления по формуле 1, вычисления по формуле 2, после чего выполнить вычисления по формуле 3, которые выглядят следующим образом: результат вычислений 1 + результат вычислений 2 – результат вычислений 1
</pre>

<pre>
Выполнить последовательно на 10 000 итераций и 100 000 итераций
Формула 1: f(x) = x^2-x^2+x*4-x*5+x+x
Формула 2: f(x) = x+x
Вывести длительность выполнения всех 10 000 итераций и 100 000 итераций в сек
</pre>

2. [C++ THREADS] Параллельные вычисления через потоки

<pre>
Требуется параллельно (насколько возможно с помощью потоков) выполнить вычисления по формуле 1, вычисления по формуле 2, после чего выполнить вычисления по формуле 3, которые выглядят следующим образом: результат вычислений 1 + результат вычислений 2 – результат вычислений 1
</pre>

<pre>
Выполнить последовательно на 10 000 итераций и 100 000 итераций
Формула 1: f(x) = x^2-x^2+x*4-x*5+x+x
Формула 2: f(x) = x+x
Вывести длительность выполнения всех 10 000 итераций и 100 000 итераций в сек. в разбивке по шагам вычислений 1, 2 и 3
</pre>

3. [C++ PROCESS] Параллельные вычисления через процессы

<pre>
Требуется параллельно (насколько возможно с помощью процессов) выполнить вычисления по формуле 1, вычисления по формуле 2, после чего выполнить вычисления по формуле 3, которые выглядят следующим образом: результат вычислений 1 + результат вычислений 2 – результат вычислений 1
</pre>

<pre>
Выполнить последовательно на 10 000 итераций и 100 000 итераций
Формула 1: f(x) = x^2-x^2+x*4-x*5+x+x
Формула 2: f(x) = x+x
Вывести длительность выполнения всех 10 000 итераций и 100 000 итераций в сек. в разбивке по шагам вычислений 1, 2 и 3
</pre>

4. [LOG] Результат всех вышеперечисленных шагов сохранить в репозиторий (+ отчет по данной ЛР в папку doc)
Фиксацию ревизий производить строго через ветку dev. С помощью скриптов накатить ревизии на stg и на prd. Скрипты разместить в корне репозитория. Также создать скрипты по возврату к виду текущей ревизии (даже если в папке имеются несохраненные изменения + новые файлы).

# Решение

1. [С++ SEQUENCE] Последовательные вычисления

<pre>
Требуется последовательно выполнить вычисления по формуле 1, вычисления по формуле 2, после чего выполнить вычисления по формуле 3, которые выглядят следующим образом: результат вычислений 1 + результат вычислений 2 – результат вычислений 1
</pre>

<pre>
Выполнить последовательно на 10 000 итераций и 100 000 итераций
Формула 1: f(x) = x^2-x^2+x*4-x*5+x+x
Формула 2: f(x) = x+x
Вывести длительность выполнения всех 10 000 итераций и 100 000 итераций в сек
</pre>

```
0.000642663 s
x' = -nan
0.00660441 s
x' = -nan
```

2. [C++ THREADS] Параллельные вычисления через потоки

<pre>
Требуется параллельно (насколько возможно с помощью потоков) выполнить вычисления по формуле 1, вычисления по формуле 2, после чего выполнить вычисления по формуле 3, которые выглядят следующим образом: результат вычислений 1 + результат вычислений 2 – результат вычислений 1
</pre>

<pre>
Выполнить последовательно на 10 000 итераций и 100 000 итераций
Формула 1: f(x) = x^2-x^2+x*4-x*5+x+x
Формула 2: f(x) = x+x
Вывести длительность выполнения всех 10 000 итераций и 100 000 итераций в сек. в разбивке по шагам вычислений 1, 2 и 3
</pre>

```
0.560441 s
x' = -nan
5.33289 s
x' = -nan
```

3. [C++ PROCESS] Параллельные вычисления через процессы

<pre>
Требуется параллельно (насколько возможно с помощью процессов) выполнить вычисления по формуле 1, вычисления по формуле 2, после чего выполнить вычисления по формуле 3, которые выглядят следующим образом: результат вычислений 1 + результат вычислений 2 – результат вычислений 1
</pre>

<pre>
Выполнить последовательно на 10 000 итераций и 100 000 итераций
Формула 1: f(x) = x^2-x^2+x*4-x*5+x+x
Формула 2: f(x) = x+x
Вывести длительность выполнения всех 10 000 итераций и 100 000 итераций в сек. в разбивке по шагам вычислений 1, 2 и 3
</pre>

Поскольку согласно (https://stackoverflow.com/questions/35300580/does-the-c-standard-support-processes), C++ не поддерживает процессы через стандартную библиотеку, то можно воспользоваться ближайшей заменой в виде Boost.Process:
```sh
sudo apt install libboost-all-dev
```
Для 100 и 1000 операций:
```
0.418882 s
x' = 1.26764e+30
5.23863 s
x' = -nan
```

4. [LOG] Результат всех вышеперечисленных шагов сохранить в репозиторий (+ отчет по данной ЛР в папку doc)
Фиксацию ревизий производить строго через ветку dev. С помощью скриптов накатить ревизии на stg и на prd. Скрипты разместить в корне репозитория. Также создать скрипты по возврату к виду текущей ревизии (даже если в папке имеются несохраненные изменения + новые файлы).
# Заключение

Последовательное выполнение простых инструкций намного быстрее параллельного, если задача плохо разделима на потоки. Процессы в ~100 раз медленнее потоков.

Выполнив ЛР, я получил первый опыт работы с boost и процессами в C++, научился лучше обрабатывать ввод для чисел с плавающей точкой. 